---
interface Props {
  currentPage: number;
  totalPages: number;
  baseUrl: string;
  class?: string;
}

const { currentPage, totalPages, baseUrl, class: className = '' } = Astro.props;

// Generate page numbers to display
function getPageNumbers(current: number, total: number): (number | string)[] {
  const pages: (number | string)[] = [];

  if (total <= 7) {
    // Show all pages if 7 or fewer
    for (let i = 1; i <= total; i++) {
      pages.push(i);
    }
  } else {
    // Always show first page
    pages.push(1);

    if (current > 3) {
      pages.push('...');
    }

    // Show current page and neighbors
    for (let i = Math.max(2, current - 1); i <= Math.min(total - 1, current + 1); i++) {
      pages.push(i);
    }

    if (current < total - 2) {
      pages.push('...');
    }

    // Always show last page
    pages.push(total);
  }

  return pages;
}

const pageNumbers = getPageNumbers(currentPage, totalPages);
const prevPage = currentPage > 1 ? currentPage - 1 : null;
const nextPage = currentPage < totalPages ? currentPage + 1 : null;

function getPageUrl(page: number): string {
  return page === 1 ? baseUrl : `${baseUrl}/${page}`;
}
---

<nav aria-label="Pagination" class={`flex items-center justify-center gap-2 ${className}`}>
  <!-- Previous Button -->
  {prevPage ? (
    <a
      href={getPageUrl(prevPage)}
      class="px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:bg-slate-100 transition-colors"
      aria-label="Go to previous page"
    >
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
    </a>
  ) : (
    <span class="px-3 py-2 rounded-md text-sm font-medium text-slate-400 cursor-not-allowed" aria-disabled="true">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
    </span>
  )}

  <!-- Page Numbers -->
  <div class="flex items-center gap-1">
    {pageNumbers.map((page) => (
      typeof page === 'number' ? (
        page === currentPage ? (
          <span
            class="px-4 py-2 rounded-md text-sm font-medium bg-indigo-600 text-white"
            aria-current="page"
          >
            {page}
          </span>
        ) : (
          <a
            href={getPageUrl(page)}
            class="px-4 py-2 rounded-md text-sm font-medium text-slate-700 hover:bg-slate-100 transition-colors"
            aria-label={`Go to page ${page}`}
          >
            {page}
          </a>
        )
      ) : (
        <span class="px-2 py-2 text-slate-400" aria-hidden="true">...</span>
      )
    ))}
  </div>

  <!-- Next Button -->
  {nextPage ? (
    <a
      href={getPageUrl(nextPage)}
      class="px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:bg-slate-100 transition-colors"
      aria-label="Go to next page"
    >
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </a>
  ) : (
    <span class="px-3 py-2 rounded-md text-sm font-medium text-slate-400 cursor-not-allowed" aria-disabled="true">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </span>
  )}
</nav>
